@using b2b_solution.Models;
@using System.Data;

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Home Page";
    DataModel dm = new DataModel();
}



<main class="main">

    <section class="home-slider position-relative mb-30">
        <div class="container">
            <div class="home-slide-cover mt-30">
                <div class="hero-slider-1 style-4 dot-style-1 dot-style-1-position-1">
                    @{ try
                        {
                            DataTable dtSlider = dm.loadList("Selbanners", "sp_B2B_Home");
                            foreach (DataRow dr in dtSlider.Rows)
                            {
                                <div class="single-hero-slider single-animation-wrap image "
                                     style="background-image:url(@dr["bnr_Image"].ToString()) ">
                                    <div class="slider-content">

                                    </div>
                                </div>
                            }
                        }
                        catch
                        {
                            <div class="single-hero-slider single-animation-wrap" style="background-image: url(../content/imgs/sliders/slider-1.png)">
                                <div class="slider-content">
                                    <h1 class="display-2 mb-40">
                                        Don’t miss amazing<br />
                                        deals
                                    </h1>
                                    <p class="mb-65">Great B2B Offers</p>
                                </div>
                            </div>
                        }
                    }

                </div>
                <div class="slider-arrow hero-slider-1-arrow"></div>
            </div>
        </div>
    </section>

    <section class="popular-categories section-padding" hidden="hidden">
        <div class="container wow animate__animated animate__fadeIn">
            <div class="section-title">
                <div class="title">
                    <h3>Featured Categories</h3>
                </div>
                <div class="slider-arrow slider-arrow-2 flex-right carausel-10-columns-arrow" id="carausel-10-columns-arrows"></div>
            </div>
            <div class="carausel-10-columns-cover position-relative">
                <div class="carausel-10-columns" id="carausel-10-columns">



                    @{
                        DataTable dtSubCats = dm.loadList("SelSubCats", "sp_B2B_Home", Session["CusID"].ToString());
                        int i = 0;
                        foreach (DataRow dr in dtSubCats.Rows)
                        {
                            using (Html.BeginForm("Search", "Home", FormMethod.Post, new { id = "subcats-" + @dr["sct_ID"].ToString() }))
                            {
                                @Html.Editor("sctID", new { htmlAttributes = new { @hidden = "hidden", @id = "Homesct-" + @dr["sct_ID"].ToString(), @Value = @dr["sct_ID"].ToString() } })
                                @Html.Editor("catID", new { htmlAttributes = new { @hidden = "hidden", @id = "HomeCat-" + @dr["sct_ID"].ToString(), @Value = @dr["sct_cat_ID"].ToString() } })
                                <div onclick="document.forms['subcats-@dr["sct_ID"].ToString()'].submit();" class="card-2 bg-@i wow animate__animated animate__fadeInUp" data-wow-delay=".1s">
                                    <figure class="img-hover-scale overflow-hidden">
                                        <a><img src="@dr["sct_Image"].ToString()" alt="" /></a>
                                    </figure>
                                    <h6><a>@dr["sct_Name"].ToString()</a></h6>
                                    <span>@dr["itmCount"].ToString() items</span>
                                </div>
                            }
                            i++;
                        }
                    }

                </div>
            </div>
        </div>
    </section>



    @{
        DataTable dtPromo = dm.loadList("SelPromotions", "sp_B2B_Promotions", Session["CusID"].ToString());
        if (dtPromo.Rows.Count > 0)
        {

            <section class="section-padding pb-5">
                <div class="container">
                    <div class="section-title wow animate_animated animate_fadeIn" data-wow-delay="0">
                        <h3 class="">Deals & Promotions </h3>
                        <a href="/Promotion/AllPromotions">
                            View All
                            <i class="fi-rs-angle-right"></i>
                        </a>
                    </div>
                    <div class="row">
                        @{
                            foreach (DataRow dr in dtPromo.Rows)
                            {
                                <div class="col-xl-3 col-lg-4 col-md-6">
                                    <div class="product-cart-wrap style-2 wow animate_animated animate_fadeInUp" data-wow-delay="0">
                                        <div class="product-img-action-wrap">
                                            <div class="product-img">
                                                <a href="/Promotion/Detail?id=@dr["prm_ID"].ToString()">
                                                    <img src="@dr["prm_Image"].ToString()" alt="" />
                                                </a>
                                            </div>
                                        </div>
                                        <div class="product-content-wrap">
                                            <div class="deals-countdown-wrap">
                                                <div class="deals-countdown" data-countdown="@dr["rcp_EndDate"].ToString()"></div>
                                            </div>
                                            <div class="deals-content">
                                                <h2><a href="/Promotion/Detail?id=@dr["prm_ID"].ToString()">@dr["prm_Name"].ToString()</a></h2>
                                                <div>
                                                    <span class="font-small text-muted">@dr["itmCount"].ToString() Items</span>
                                                </div>
                                                <div class="product-card-bottom">
                                                    <div class="add-cart">

                                                        @{
                                                            string page = dr["prt_Page"].ToString();

                                                            <a class="add" href="/Promotion/@page?id=@dr["prm_ID"].ToString()"><i class="fi-rs-angle-right mr-5"></i>View Details </a>
                                                        }

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        }

                    </div>
                </div>
            </section>


        }

    }



    <section class="banners mb-25">


        <div class="container">
            <div class="section-title">
                <div class="title">
                    <h3>Featured Categories</h3>
                </div>
                <div class="slider-arrow slider-arrow-2 flex-right carausel-10-columns-arrow" id="carausel-10-columns-arrows"></div>
            </div>
            <div class="row">
                @{
                    DataTable dt = dm.loadList("SelFeaturedCategories", "sp_B2B_Home");
                    foreach (DataRow dr in dt.Rows)
                    {
                        <div class="col-lg-4 col-md-6">
                            <div class="banner-img wow animate__animated animate__fadeInUp" data-wow-delay="0">
                                <img src="@dr["fct_Image"].ToString()" onclick="javascript:Search('@dr["tct_cat_ID"]', '0', '@dr["cat_Name"].ToString()', '')" alt="" width="100%" />
                                <div class="banner-text">

                                    <a href="javascript:Search('@dr["tct_cat_ID"]', '0', '@dr["cat_Name"].ToString()', '')" class="btn btn-xs"> @dr["fct_Name"].ToString() <i class="fi-rs-arrow-small-right"></i></a>
                                </div>
                            </div>
                        </div>
                    }

                }


            </div>
        </div>

    </section>

    <section class="product-tabs section-padding position-relative">
        <div class="container">
            <div class="section-title style-2 wow animate__animated animate__fadeIn mb-4">
                <h3>Frequently Ordered Items</h3>


            </div>
            @{
                string Roles = Session["Roles"].ToString();
                if (Roles.Contains("AD") || Roles.Contains("OT"))
                {

                }
                else
                {
                    <div class="section-title style-2 wow animate__animated animate__fadeIn fs-6">
                        <span>  Finance users do not have the permission to place an order.</span>
                    </div>
                }
            }
            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                    <div class="row product-grid-4">

                        @{
                            Html.RenderPartial("Products");
                        }
                    </div>
                </div>
            </div>

        </div>
    </section>
    <section>
        <div class="row">
            <div class=" col-lg-12 row d-flex justify-content-center">
                <button onclick="window.location.href='/Home/Search?prdName='" class="btn btn-heading btn-block hover-up" style="width: 200px;">
                    Show All Products
                </button>
            </div>
        </div>
    </section>
    <section class="section-padding pb-5 mb-20">
        <div class="container">
            <div class="section-title wow animate__animated animate__fadeIn" data-wow-delay="0">
                <h3 class="">Brands We Carry</h3>
                <a class="show-all" href="/Home/Brands">
                    All Brands
                    <i class="fi-rs-angle-right"></i>
                </a>
            </div>
            <div class=" col-lg-12 row">

                @{
                    DataTable dtBrands = dm.loadList("SelBrands", "sp_B2B_Home", Session["CusID"].ToString());
                    foreach (DataRow dr in dtBrands.Rows)
                    {
                        <div class="col-lg-2">
                            <div class="style-2 wow animate__animated animate__fadeInUp" data-wow-delay="0">
                                <div class="product-img-action-wrap">
                                    <div class="product-img text-center">
                                        <a onclick="Search('0', '@dr["brd_ID"].ToString()','' , '@dr["brd_Name"].ToString()' )">
                                            <img height="150" src="@dr["brd_Image"]" alt="@dr["brd_Name"]" />
                                        </a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    }
                }
            </div>
            <div class="row">

            </div>


        </div>
    </section>

</main>



<style>
    img {
        max - width: 100%;
        max-height: 100%;
    }

    .square {
        height: 300px !important;
        max-width: 100% !important;
        max-height: 100% !important;
        width: 100% !important;
    }
</style>